function submitTellMeShop(e){const t=$("#tellme-btn").data("site-key"),o=$("#modal-tell-me").find(".modal-loading");executedTellMeShop||(executedTellMeShop=!0,o.show(),grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(t,{action:"submit"}).then(function(e){$.ajax({url:base_url+"produto/aviseme/add2",data:{nome:$("#tellme-nome").val(),email:$("#tellme-email").val(),produto_id:$("#tellme-produto-id").val(),produto_estoque_id:$("#tellme-sku").val(),"g-recaptcha-response":e},dataType:"json",type:"POST",success:function(e){$("#tellme-btn").find(".btn-text").removeClass("loading-button"),-1==e.id?$.message.show("error",{vars:{title:e.mensagem},idleTime:3500}):($(".modal-mask").hide(),$(".modal").hide(),$.message.show("success",{vars:{title:"Aviso cadastrado com sucesso!",idleTime:3500}})),o.hide(),executedTellMeShop=!1}})})}))}$(function(){function e(e){return e.children(".product-list-item-inner").children(".wrapper-product-combination").find(".product-combination-list")}function t(t,o){var u=t.closest(".product-list-item").find(".wrapper-btn-product"),p=t.closest(".product-list-item"),m=t.closest(".product-list-item-inner").find(".product-image");ProductModel.id=p.data("id");var h=ProductModel.getChecked(e(p));t.find(".product-comb-attribute").prop("checked")&&ProductModel.find(h,function(){},function(e){s(t,0,m);var o=m.children("a");if(null!==e.id){if(a(t,e),i(t,e.valor_venda_unitario),c(t,e.parcelas,e.valor_parcelado),r(t,e.desconto_avista,e.valor_avista),l(t,e.combinacoes),d(t,null,0),n(u,t,0,e),$(e.img).css("opacity",1),!0!==e.disponivel&&(s(t,1,m),d(t,e,1),n(u,t,1,e),$(e.img).css("opacity",.5)),$(e.img).fadeIn(500),o.children("img").remove(),o.append(e.img),0!=e.imgsec){o.children("img:first-child").addClass("image-main");var p=document.createElement("img");p.src=base_url_image+"/sku/thumb_"+e.imgsec,p.style.cssText="display:none;",p.setAttribute("class","image-over"),o.append(p)}}else s(t,1,m),d(t,e,1),n(u,t,1,e)})}function o(t,o){var u=t.closest(".product-list-item").find(".wrapper-btn-product"),p=t.closest(".product-list-item"),m=$(p).find(".product-image");m.children("a").children("img");ProductModel.id=p.data("id");var h=ProductModel.getChecked(e(p));t.find(".product-comb-attribute").prop("checked")&&ProductModel.find(h,null,function(e){s(t,0,m),null!==e.id?(a(t,e),i(t,e.valor_venda_unitario),c(t,e.parcelas,e.valor_parcelado),r(t,e.desconto_avista,e.valor_avista),l(t,e.combinacoes),s(t,0,m),d(t,null,0),n(u,t,0,e),!0!==e.disponivel&&(s(t,1,m),d(t,e,1),n(u,t,1,e),$(e.img).css("opacity",.5))):(s(t,1,m),d(t,e,1),n(u,t,1,e),$(p).addClass("comb-unavailable"))})}function a(e,t){var o=e.closest(".product-list-item-inner"),a=o.find(".product-old-price"),i=e.closest(".product-list-item-inner").find(".label-promo");t.promocao&&null!==t.valor_original?(a.show(),i.html(t.percentual_promocao),i.show(),a.removeClass("product-price"),a.children("span:nth-child(1)").html("de "),a.children("span:nth-child(2)").html(accounting.formatMoney(t.valor_original)),a.children("span:nth-child(2)").attr("class","product-strikethrough-price")):(a.find("span").html(""),i.hide(),a.hide())}function i(e,t){var o=e.closest(".product-list-item-inner"),a=o.find(".product-sell-price");a.children("span:nth-child(1)").html("Por "),a.children("span:nth-child(2)").html(""),a.children("span:nth-child(2)").html(accounting.formatMoney(t)),a.children("span:nth-child(2)").attr("class","product-big-price")}function c(e,t,o){var a=e.closest(".product-list-item-inner"),i=a.find(".product-parcelled-price");i.children(".product-number-parcels").html(""),i.children(".product-number-parcels").html(t+"x"),i.children(".product-big-price").html(""),i.children(".product-big-price").html(accounting.formatMoney(o))}function r(e,t,o){if(t>0){var a=e.closest(".product-list-item-inner"),i=a.find(".product-cash-price");i.children(".product-big-price").html(""),i.children(".product-big-price").html(accounting.formatMoney(o)),i.children(".product-price-off").html(""),i.children(".product-price-off").html(t+"%")}}function l(e,t){var o=$(e).closest(".wrapper-product-combination");o.html("");var a="";$.each(t,function(e,t){a+='<span class="product-combination-title">'+t.label+'</span><ul class="product-combination-list">',$.each(t.CombinacaoAtributo,function(e,o){var i=1==o.disponivel?"":" product-combination-unavailable",c=1==o.selecionado?" product-combination-active":"",r=1==t.mostra_vitrine?" active-combination":"",l=1==o.selecionado?' checked="checked" ':"",n=m(o);a+='<li class="product-combination-item'+i+c+" "+t.classes_adicionais+'"><label for="CatalogoCombinacaoAtributoId'+t.produto_id+t.id+o.id+'" title="'+o.nome+'">'+n+"</label>"+(1==o.disponivel?"":'<span class="label-product-combination-unavailable">x</span>')+'<input type="hidden" name="data[CatalogoCombinacaoAtributo][id]['+t.produto_id+"]["+t.id+"]["+o.id+']" id="CatalogoCombinacaoAtributoId'+t.produto_id+t.id+o.id+'_" value="0"><input type="checkbox" name="data[CatalogoCombinacaoAtributo][id]['+t.produto_id+"]["+t.id+"]["+o.id+']" value="'+o.id+'"'+l+'class="comb-'+t.id+" product-comb-attribute"+r+" prod-"+t.produto_id+'" data-order="'+t.ordem+'" id="CatalogoCombinacaoAtributoId'+t.produto_id+t.id+o.id+'"></li>'}),a+="</ul>"}),o.html(a),o.removeClass("product-combination-loading")}function n(e,t,o,a){if(1==o)var i='<div class="wrapper-btn-buy"><a href="javascript:;" class="btn btn-tell-me"><span class="icon-buy icon-tell-me btn-icon"></span><span class="btn-text">'+a.msg_aviseme+"</span></a></div>";else if(0==o)i='<div class="wrapper-btn-buy"><a href="javascript:;" class="btn btn-buy"><span class="icon-buy btn-icon"></span><span class="btn-text">'+a.label_comprar+"</span></a></div>";e.html(i)}function d(e,t,o){if(1==o){"0"==t.exibe_preco_aviseme&&p(e);var a=$(".modal-product-info").children(".product-price");a.html(t.sku),$("#tellme-sku").val(t.id),e.closest(".product-list-item").attr("data-sku",$("#tellme-sku").val())}else if(0==o){var i=$(e).closest(".product-list-item-inner").children(".product-info");i.find("p").show(),i.find(".product-sku").hide()}}function s(e,t,o){var a=o.children("a").attr("href"),i='<a class="label-product label-unavailable" href="'+a+'">Produto Indisponível</a>';1==t?(o.find(".label-unavailable").remove(),$(o).append(i)):0==t&&o.find(".label-unavailable").remove()}function u(e){var t=new Array,o="";return e.closest(".product-list-item").find(".product-combination-list").each(function(){o=$(this).prev().text(),t[t.length]=o}),t}function p(e){var t=$(e).closest(".product-list-item-inner").children(".product-info");t.find("p").hide(),t.find(".product-name").show()}function m(e){var t="";return"imagem"==e.tipo_capa?t='<div class="combination-image"><img src="'+base_url_image+"/combinacao_atributo/thumb_"+e.name+'" alt=""></div>':"cor"==e.tipo_capa?(t='<div style="background-color:#'+e.cor_primaria.replace("#","")+'" >',null!=e.cor_secundaria&&""!=e.cor_secundaria&&(t+='<span style="border-color:#'+e.cor_secundaria.replace("#","")+'"></span>'),t+="</div>"):t="<div>"+e.nome+"</div>",t}ProductModel.init(),$(document).on("click",".product-combination-item",function(e){e.preventDefault(),$(this).find(".product-comb-attribute").prop("checked",!0);var a=$(this).find(".product-comb-attribute").val();this.className.split(" ").pop(),this.className.split(" ").shift();$(this).closest(".product-combination-list").find('.product-comb-attribute[value="'+a+'"]').prop("checked",!0).parent().addClass("product-combination-active"),$(this).closest(".product-combination-list").find('.product-comb-attribute[value!="'+a+'"]').prop("checked",!1).parent().removeClass("product-combination-active"),$(this).closest(".wrapper-product-combination").addClass("product-combination-loading"),$(this).find(".product-comb-attribute").hasClass("active-combination")?t($(this)):o($(this))}),$(document).on("click",".btn-disabled",function(){return!1}),$(document).on("click",".btn-buy",function(t){var o=$(this),a=o.children(".btn-text"),i=o.closest(".product-list-item");ProductModel.id=i.data("id");var c=e(i),r=new Array,l=ProductModel.getChecked(c),n=e(i).size();if(n==l.length){t.preventDefault();o.hasClass("btn-disabled")||(o.addClass("btn-disabled"),a.addClass("loading-button"),$(".loading-page").show(),ProductModel.cartCreateProduct(l,r,function(){},function(e){if(e.alerta_quantidade)1==e.alerta_quantidade?($(".loading-page").hide(),a.removeClass("loading-button"),$.message.show("error",{vars:{title:"Produto indisponível"},idleTime:4e3})):($(".loading-page").hide(),a.removeClass("loading-button"),$.message.show("error",{vars:{title:e.alerta_quantidade.replace(".",",")},idleTime:4e3}));else{$(".shopping-cart-total-price");var t=i.children().children(".product-image").children("a").children("img");if("3"==e.acao_comprar||"4"==e.acao_comprar){var c=base_url+"carrinho";$(location).attr("href",c)}else $(".loading-page").hide(),a.removeClass("loading-button"),$.message.show(e.continuar_comprando);App.refreshCartIcon(e),App.addProductIcon(e,t)}setTimeout(function(){o.removeClass("btn-disabled")},1100)}))}else{var d=u(o);$.message.show("error",{vars:{title:"Você precisa selecionar as combinações:<br/>"+d.join(", ")},idleTime:4e3})}}),$(document).on("click",".btn-tell-me",function(t){var o=$(this),a=(o.children(".btn-text"),o.closest(".product-list-item"));ProductModel.id=a.data("id");var i=e(a),c=(new Array,ProductModel.getChecked(i)),r=e(a).size(),l=$(this).closest(".product-list-item").data("id"),n=$(this).closest(".product-list-item-inner").find(".product-image").children("a").children("img").attr("src"),d=$(this).closest(".product-list-item-inner").find(".product-name").children("a").html(),s=$(this).closest(".product-list-item").data("sku"),u=$(".modal-product-image").children("img"),p=$(".modal-product-info").children(".product-name"),m=$(".modal-product-info").children(".product-price");u.attr("src",n),p.html(d),m.html(s),$("#tellme-sku").val(s),$("#tellme-produto-id").val(l),r==c.length?$.modal.show(null,"modal-tell-me"):$.message.show("error",{vars:{title:"Você precisa selecionar todas as combinações."},idleTime:4e3})}),$(document).on("click",".btn-budget",function(){var e=$("#form-budget"),t=$(this).closest(".product-list-item-inner"),o=$(this).closest(".product-list-item").data("id"),a=$(this).closest(".product-list-item").data("sku"),i=$(".modal-product-image").children("img"),c=$(".modal-product-info").children(".product-name"),r=t.find(".product-image").children("a").children("img").attr("src"),l=t.find(".product-name").children("a").html();e.find("#CotacaoProdutoId").val(o),e.find("#CotacaoEstoqueId").val(a),i.attr("src",r),c.html(l),$.modal.show(null,"modal-budget")}),$(document).on("click","#budget-btn",function(){var e=$("#form-budget").valid();if(e){var t=$("#g-recaptcha-response").val();if(t.length>0){var o={},a=WsRouter.generateRoute(null,"produto","cotacaoProduto",null);o={clienteNome:$("#CotacaoNome").val(),clienteEmail:$("#CotacaoEmail").val(),clienteTelefone:$("#CotacaoTelefone").val(),clienteObservacao:$("#CotacaoObservacao").val(),clienteLogradouro:$("#CotacaoLogradouro").val(),clienteNumero:$("#CotacaoNumero").val(),clienteComplemento:$("#CotacaoComplemento").val(),clienteBairro:$("#CotacaoBairro").val(),clienteCidade:$("#CotacaoCidade").val(),clienteEstado:$("#CotacaoEstado").val(),clienteCep:$("#CotacaoCep").val(),produtoId:$("#CotacaoProdutoId").val(),produtoEstoqueId:$("#CotacaoEstoqueId").val(),quantidade:$("#CotacaoQuantidade").val(),recaptcha_response:t},WsDispatcher.postRequest(a,{VendaCotacao:JSON.stringify(o)},null,function(e){1==e.status?($.modal.hide("fadeInUp","modal-budget"),$.message.show("success",{vars:{title:e.message},idleTime:4e3})):$.message.show("error",{vars:{title:e.message},idleTime:4e3})})}else{var i='<label id="g-recaptcha-response-error" class="error" for="g-recaptcha-response">Você precisa completar o Captcha de segurança.</label>';$("#g-recaptcha-response-error").remove(),$("#div-captcha-budget").append(i)}}})});let executedTellMeShop=!1;